(()=>{"use strict";const e=(e,t)=>new Promise((i=>{let r=t.querySelector(e);r?i(r):new MutationObserver(((r,s)=>{Array.from(t.querySelectorAll(e)).forEach((e=>{i(e),s.disconnect()}))})).observe(t,{childList:!0,subtree:!0})})),t={trailing:!0};const i="/pdfjs",r="/web/viewer.html",s="",n="",o="",l="",a="",c="none",h="",u="",d="AUTOMATIC",m="",w="",f="",v={AUTOMATIC:0,LIGHT:1,DARK:2},y=["src","viewer-path","locale","text-layer","viewer-css-theme","viewer-extra-styles","viewer-extra-styles-urls"];class p extends HTMLElement{constructor(){super(),this.onIframeReady=function(e,i=25,r={}){if(r={...t,...r},!Number.isFinite(i))throw new TypeError("Expected `wait` to be a finite number");let s,n,o,l,a=[];const c=(t,i)=>(o=async function(e,t,i){return await e.apply(t,i)}(e,t,i),o.finally((()=>{if(o=null,r.trailing&&l&&!n){const e=c(t,l);return l=null,e}})),o);return function(...e){return o?(r.trailing&&(l=e),o):new Promise((t=>{const o=!n&&r.leading;clearTimeout(n),n=setTimeout((()=>{n=null;const t=r.leading?s:c(this,e);for(const e of a)e(t);a=[]}),i),o?(s=c(this,e),t(s)):a.push(t)}))}}((async t=>{await e("iframe",this.shadowRoot),t()}),0,{leading:!0}),this.setViewerExtraStyles=(e,t="extra")=>{var i,r,s,n,o;if(!e)return void(null==(r=null==(i=this.iframe.contentDocument)?void 0:i.head.querySelector(`style[${t}]`))||r.remove());if((null==(n=null==(s=this.iframe.contentDocument)?void 0:s.head.querySelector(`style[${t}]`))?void 0:n.innerHTML)===e)return;const l=document.createElement("style");l.innerHTML=e,l.setAttribute(t,""),null==(o=this.iframe.contentDocument)||o.head.appendChild(l)},this.injectExtraStylesLinks=e=>{e&&e.replace(/'|]|\[/g,"").split(",").map((e=>e.trim())).forEach((e=>{var t,i;if(null==(t=this.iframe.contentDocument)?void 0:t.head.querySelector(`link[href="${e}"]`))return;const r=document.createElement("link");r.rel="stylesheet",r.href=e,null==(i=this.iframe.contentDocument)||i.head.appendChild(r)}))},this.initialize=()=>new Promise((async t=>{var i;await e("iframe",this.shadowRoot),null==(i=this.iframe)||i.addEventListener("load",(async()=>{var e,i,r;await(null==(i=null==(e=this.iframe.contentWindow)?void 0:e.PDFViewerApplication)?void 0:i.initializedPromise),t(null==(r=this.iframe.contentWindow)?void 0:r.PDFViewerApplication)}),{once:!0})}));const i=this.attachShadow({mode:"open"}),r=document.createElement("template");r.innerHTML='\n      <style>:host{width:100%;display:block;overflow:hidden}:host iframe{height:100%}</style>\n      <iframe frameborder="0" width="100%" loading="lazy"></iframe>\n    ',i.appendChild(r.content.cloneNode(!0))}static get observedAttributes(){return["src","viewer-path","locale","page","search","phrase","zoom","pagemode","text-layer","viewer-css-theme","viewer-extra-styles","viewer-extra-styles-urls","nameddest"]}connectedCallback(){this.iframe=this.shadowRoot.querySelector("iframe"),document.addEventListener("webviewerloaded",(async()=>{var e,t,i,r,n,o,l,a;this.setCssTheme(this.getCssThemeOption()),this.injectExtraStylesLinks(this.getAttribute("viewer-extra-styles-urls")??w),this.setViewerExtraStyles(this.getAttribute("viewer-extra-styles")??m),this.getAttribute("src")!==s&&(null==(t=null==(e=this.iframe.contentWindow)?void 0:e.PDFViewerApplicationOptions)||t.set("defaultUrl","")),null==(r=null==(i=this.iframe.contentWindow)?void 0:i.PDFViewerApplicationOptions)||r.set("disablePreferences",!0),null==(o=null==(n=this.iframe.contentWindow)?void 0:n.PDFViewerApplicationOptions)||o.set("pdfBugEnabled",!0),null==(a=null==(l=this.iframe.contentWindow)?void 0:l.PDFViewerApplicationOptions)||a.set("eventBusDispatchToDOM",!0)}))}attributeChangedCallback(e){y.includes(e)?this.onIframeReady((()=>this.mountViewer(this.getIframeSrc()))):this.onIframeReady((()=>{this.iframe.src=this.getIframeSrc()}))}getIframeSrc(){const e=this.getFullPath(this.getAttribute("src")||s),t=this.getFullPath(this.getAttribute("viewer-path")||i),w=this.getAttribute("page")||n,v=this.getAttribute("search")||o,y=this.getAttribute("phrase")||l,g=this.getAttribute("zoom")||a,b=this.getAttribute("pagemode")||c,A=this.getAttribute("locale")||h,x=this.getAttribute("text-layer")||u,E=this.getAttribute("viewer-css-theme")||d,T=!(!this.getAttribute("viewer-extra-styles")&&!m),S=this.getAttribute("nameddest")||f;return`${t}${r}?file=${encodeURIComponent(e)}#page=${w}&zoom=${g}&pagemode=${b}&search=${v}&phrase=${y}&textLayer=${x}${A?"&locale="+A:""}&viewerCssTheme=${E}&viewerExtraStyles=${T}${S?"&nameddest="+S:""}`}mountViewer(e){!e||!this.iframe||(this.shadowRoot.replaceChild(this.iframe.cloneNode(),this.iframe),this.iframe=this.shadowRoot.querySelector("iframe"),this.iframe.src=e)}getFullPath(e){return e.startsWith("/")?`${window.location.origin}${e}`:e}getCssThemeOption(){const e=this.getAttribute("viewer-css-theme");return Object.keys(v).includes(e)?v[e]:v[d]}setCssTheme(e){var t,i,r;if(e===v.DARK){const e=null==(t=this.iframe.contentDocument)?void 0:t.styleSheets[0],i=(null==e?void 0:e.cssRules)||[],r=Object.keys(i).filter((e=>{var t;return"(prefers-color-scheme: dark)"===(null==(t=i[Number(e)])?void 0:t.conditionText)})).map((e=>i[Number(e)].cssText.split("@media (prefers-color-scheme: dark) {\n")[1].split("\n}")[0]));this.setViewerExtraStyles(r.join(""),"theme")}else null==(r=null==(i=this.iframe.contentDocument)?void 0:i.head.querySelector("style[theme]"))||r.remove()}}window.customElements.get("pdfjs-viewer-element")||(window.PdfjsViewerElement=p,window.customElements.define("pdfjs-viewer-element",p))})();